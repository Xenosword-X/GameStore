import{c as u,o as v,a,d as o,e as r,g as i,f as _,w as f,h as l,s as h,u as m,r as g,z as k,F as x}from"./index-Drcz_wGL.js";const y={class:"navbar navbar-expand-lg navbar-dark bg-dark"},w={class:"container-fluid"},$={class:"collapse navbar-collapse",id:"navbarNav"},A={class:"navbar-nav"},N={class:"nav-item"},T={class:"nav-item"},z={class:"nav-item"},B={class:"nav-item"},C={class:"nav-item"},M={__name:"BackNavbar",setup(b){const e=m(),n=()=>{document.cookie="hexToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",delete l.defaults.headers.common.Authorization},p=async()=>{const c="https://vue3-course-api.hexschool.io/v2/logout";try{const s=await l.post(c);if(!s.data.success)throw new Error(s.data.message||"登出失敗");n(),h("success","已成功登出"),e.push("/login")}catch(s){console.error("API 錯誤",s),n(),h("error","登出失敗，請重新登入"),e.push("/login")}};return(c,s)=>{const t=_("router-link");return v(),u("nav",y,[a("div",w,[o(t,{to:"/dashboard/products",class:"navbar-brand fw-bold"},{default:r(()=>[...s[0]||(s[0]=[i("後台管理",-1)])]),_:1}),s[5]||(s[5]=a("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[a("span",{class:"navbar-toggler-icon"})],-1)),a("div",$,[a("ul",A,[a("li",N,[o(t,{to:"/dashboard/products",class:"nav-link"},{default:r(()=>[...s[1]||(s[1]=[i("產品",-1)])]),_:1})]),a("li",T,[o(t,{to:"/dashboard/articles",class:"nav-link"},{default:r(()=>[...s[2]||(s[2]=[i("消息",-1)])]),_:1})]),a("li",z,[o(t,{to:"/dashboard/orders",class:"nav-link"},{default:r(()=>[...s[3]||(s[3]=[i("訂單",-1)])]),_:1})]),a("li",B,[o(t,{to:"/dashboard/coupons",class:"nav-link"},{default:r(()=>[...s[4]||(s[4]=[i("優惠券",-1)])]),_:1})]),a("li",C,[a("a",{class:"nav-link",href:"#",onClick:f(p,["prevent"])},"登出")])])])])])}}},V={class:"container-fluid mt-3 position-relative"},E={key:0},F={key:1,class:"d-flex justify-content-center align-items-center py-5"},j={__name:"Dashboard",setup(b){const e=m(),n=g(!1),p=s=>{s?l.defaults.headers.common.Authorization=s:delete l.defaults.headers.common.Authorization},c=async()=>{const s=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");p(s);const t="https://vue3-course-api.hexschool.io/v2/api/user/check";try{if(!(await l.post(t)).data.success){e.push("/login");return}n.value=!0}catch(d){console.error("登入驗證失敗",d),alert("登入驗證失敗，請重新登入"),e.push("/login")}};return k(()=>{c()}),(s,t)=>{const d=_("router-view");return v(),u(x,null,[o(M),a("div",V,[n.value?(v(),u("div",E,[o(d)])):(v(),u("div",F,[...t[0]||(t[0]=[a("div",{class:"spinner-border text-primary",role:"status"},[a("span",{class:"visually-hidden"},"載入中...")],-1)])]))])],64)}}};export{j as default};
